templates:
- name: transformationPod
  inputs:
    parameters:
      - name: config
      - name: command
  container:
    name: 'xain-fl'
    image: keykoio/xain-fl:latest
    imagePullPolicy: IfNotPresent
    command: ["{{inputs.parameters.command}}"]
    args: ["-c", "{{inputs.parameters.config}}"]

- name: coordinator
  dag:
    tasks:
      - name: coordinator
        dependencies: [configurator]
        template: transformationPod
        arguments:
          parameters:
          - name: command
            value: "coordinator"
          - name: config
            value: "/bin/config-coordinator.toml"
      - name: aggregator
        dependencies: [configurator]
        template: transformationPod
        arguments:
          parameters:
          - name: command
            value: "aggregator"
          - name: config
            value: "/bin/config-aggregator.toml"
